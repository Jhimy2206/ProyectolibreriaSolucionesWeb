<div class="form-container">
  <div class="form-card">
    <header class="form-header">
      <h2>
        <i class="fas fa-book-medical"></i>
        Registrar Nuevo Libro
      </h2>
    </header>

    <form (ngSubmit)="guardarLibro()" #libroForm="ngForm" class="libro-form">
      <div class="form-group">
        <label for="titulo">
          <i class="fas fa-heading"></i>
          Título
        </label>
        <input 
          type="text" 
          id="titulo"
          name="titulo"
          [(ngModel)]="libro.titulo"
          required
          #tituloInput="ngModel"
          class="form-control"
          placeholder="Ingrese el título del libro">
        <div class="invalid-feedback" *ngIf="tituloInput.invalid && (tituloInput.dirty || tituloInput.touched)">
          El título es requerido
        </div>
      </div>

      <div class="form-group">
        <label for="autor">
          <i class="fas fa-user-edit"></i>
          Autor
        </label>
        <input 
          type="text" 
          id="autor"
          name="autor"
          [(ngModel)]="libro.autor"
          required
          #autorInput="ngModel"
          class="form-control"
          placeholder="Nombre del autor">
        <div class="invalid-feedback" *ngIf="autorInput.invalid && (autorInput.dirty || autorInput.touched)">
          El autor es requerido
        </div>
      </div>

      <div class="form-row">
        <div class="form-group col-md-6">
          <label for="anio">
            <i class="fas fa-calendar"></i>
            Año
          </label>
          <input 
            type="number" 
            id="anio"
            name="anio"
            [(ngModel)]="libro.anio"
            required
            #anioInput="ngModel"
            class="form-control"
            [max]="currentYear"
            placeholder="Año de publicación">
          <div class="invalid-feedback" *ngIf="anioInput.invalid && (anioInput.dirty || anioInput.touched)">
            Ingrese un año válido
          </div>
        </div>

        <div class="form-group col-md-6">
          <label for="categoria">
            <i class="fas fa-tag"></i>
            Categoría
          </label>
          <select 
            id="categoria"
            name="categoria"
            [(ngModel)]="libro.categoria.id"
            required
            #categoriaInput="ngModel"
            class="form-control">
            <option value="">Seleccione una categoría</option>
            <option *ngFor="let cat of categorias" [value]="cat.id">
              {{cat.nombre}}
            </option>
          </select>
          <div class="invalid-feedback" *ngIf="categoriaInput.invalid && (categoriaInput.dirty || categoriaInput.touched)">
            Seleccione una categoría
          </div>
        </div>
      </div>

      <div class="form-actions">
        <button type="button" class="btn btn-secondary" routerLink="/">
          <i class="fas fa-arrow-left"></i>
          Cancelar
        </button>
        <button 
          type="submit" 
          class="btn btn-primary"
          [disabled]="!libroForm.form.valid">
          <i class="fas fa-save"></i>
          Guardar Libro
        </button>
      </div>
    </form>
  </div>
</div>
